ž
^c:\Users\HARRY\racetrac\live_project\dating-app\backend\UserService\Services\MongoDbService.cs
	namespace 	
UserService
 
. 
Services 
{ 
public 

class 
MongoDbService 
{ 
private 
readonly 
IMongoCollection )
<) *
User* .
>. /
_users0 6
;6 7
public

 
MongoDbService

 
(

 
IConfiguration

 ,
configuration

- :
)

: ;
{ 	
var 
client 
= 
new 
MongoClient (
(( )
configuration) 6
.6 7
GetConnectionString7 J
(J K
$strK T
)T U
)U V
;V W
var 
database 
= 
client !
.! "
GetDatabase" -
(- .
$str. 9
)9 :
;: ;
_users 
= 
database 
. 
GetCollection +
<+ ,
User, 0
>0 1
(1 2
$str2 9
)9 :
;: ;
} 	
public 
async 
Task 
< 
List 
< 
User #
># $
>$ %
GetUsersAsync& 3
(3 4
)4 5
=>6 8
await 
_users 
. 
Find 
( 
_ 
=>  "
true# '
)' (
.( )
ToListAsync) 4
(4 5
)5 6
;6 7
public 
async 
Task 
< 
User 
? 
>  
GetUserAsync! -
(- .
string. 4
id5 7
)7 8
=>9 ;
await 
_users 
. 
Find 
( 
x 
=>  "
x# $
.$ %
Id% '
==( *
id+ -
)- .
.. /
FirstOrDefaultAsync/ B
(B C
)C D
;D E
public 
async 
Task 
< 
User 
? 
>  
GetUserByEmailAsync! 4
(4 5
string5 ;
email< A
)A B
=>C E
await 
_users 
. 
Find 
( 
x 
=>  "
x# $
.$ %
Email% *
==+ -
email. 3
)3 4
.4 5
FirstOrDefaultAsync5 H
(H I
)I J
;J K
public 
async 
Task 
CreateUserAsync )
() *
User* .
user/ 3
)3 4
=>5 7
await 
_users 
. 
InsertOneAsync '
(' (
user( ,
), -
;- .
public 
async 
Task 
UpdateUserAsync )
() *
string* 0
id1 3
,3 4
User5 9
user: >
)> ?
=>@ B
await 
_users 
. 
ReplaceOneAsync (
(( )
x) *
=>+ -
x. /
./ 0
Id0 2
==3 5
id6 8
,8 9
user: >
)> ?
;? @
} 
}   ´5
bc:\Users\HARRY\racetrac\live_project\dating-app\backend\UserService\Controllers\UsersController.cs
	namespace 	
UserService
 
. 
Controllers !
{ 
[ 
ApiController 
] 
[ 
Route 

(
 
$str 
) 
] 
public 

class 
UsersController  
:! "
ControllerBase# 1
{		 
private

 
static

 
List

 
<

 
User

  
>

  !
_users

" (
=

) *
new

+ .
List

/ 3
<

3 4
User

4 8
>

8 9
{ 	
new 
User 
{ 
Id 
= 
$str 
, 
Email 
= 
$str '
,' (
Password 
= 
$str  
,  !
Name 
= 
$str 
, 
Age 
= 
$num 
, 
Bio 
= 
$str .
,. /
Location 
= 
$str %
,% &
Zipcode 
= 
$str !
,! "
Gender 
= 
$str 
,  
InterestedIn 
= 
$str '
} 
} 	
;	 

[ 	
HttpPost	 
] 
public 
ActionResult 
< 
User  
>  !

CreateUser" ,
(, -
CreateUserRequest- >
request? F
)F G
{ 	
var 
user 
= 
new 
User 
{ 
Id 
= 
Guid 
. 
NewGuid !
(! "
)" #
.# $
ToString$ ,
(, -
)- .
,. /
Email   
=   
request   
.    
Email    %
,  % &
Password!! 
=!! 
request!! "
.!!" #
Password!!# +
,!!+ ,
Name"" 
="" 
request"" 
."" 
Name"" #
,""# $
Age## 
=## 
request## 
.## 
Age## !
,##! "
Bio$$ 
=$$ 
request$$ 
.$$ 
Bio$$ !
,$$! "
Location%% 
=%% 
request%% "
.%%" #
Location%%# +
,%%+ ,
Zipcode&& 
=&& 
request&& !
.&&! "
Zipcode&&" )
,&&) *
Gender'' 
='' 
request''  
.''  !
Gender''! '
,''' (
InterestedIn(( 
=(( 
request(( &
.((& '
InterestedIn((' 3
})) 
;)) 
_users++ 
.++ 
Add++ 
(++ 
user++ 
)++ 
;++ 
return,, 
CreatedAtAction,, "
(,," #
nameof,,# )
(,,) *
GetUser,,* 1
),,1 2
,,,2 3
new,,4 7
{,,8 9
id,,: <
=,,= >
user,,? C
.,,C D
Id,,D F
},,G H
,,,H I
user,,J N
),,N O
;,,O P
}-- 	
[// 	
HttpGet//	 
(// 
$str// 
)// 
]// 
public00 
ActionResult00 
<00 
User00  
>00  !
GetUser00" )
(00) *
string00* 0
id001 3
)003 4
{11 	
var22 
user22 
=22 
_users22 
.22 
FirstOrDefault22 ,
(22, -
u22- .
=>22/ 1
u222 3
.223 4
Id224 6
==227 9
id22: <
)22< =
;22= >
if33 
(33 
user33 
==33 
null33 
)33 
return44 
NotFound44 
(44  
)44  !
;44! "
return55 
user55 
;55 
}66 	
[88 	
HttpGet88	 
]88 
public99 
ActionResult99 
<99 
IEnumerable99 '
<99' (
User99( ,
>99, -
>99- .
GetUsers99/ 7
(997 8
)998 9
{:: 	
return;; 
_users;; 
;;; 
}<< 	
[>> 	
HttpPost>>	 
(>> 
$str>> 
)>> 
]>> 
public?? 
IActionResult?? 
Login?? "
(??" #
LoginRequest??# /
request??0 7
)??7 8
{@@ 	
varAA 
userAA 
=AA 
_usersAA 
.AA 
FirstOrDefaultAA ,
(AA, -
uAA- .
=>AA/ 1
uAA2 3
.AA3 4
EmailAA4 9
==AA: <
requestAA= D
.AAD E
EmailAAE J
&&AAK M
uAAN O
.AAO P
PasswordAAP X
==AAY [
requestAA\ c
.AAc d
PasswordAAd l
)AAl m
;AAm n
ifBB 
(BB 
userBB 
==BB 
nullBB 
)BB 
returnCC 
UnauthorizedCC #
(CC# $
newCC$ '
{CC( )
messageCC* 1
=CC2 3
$strCC4 O
}CCP Q
)CCQ R
;CCR S
returnEE 
OkEE 
(EE 
userEE 
)EE 
;EE 
}FF 	
[HH 	
HttpPostHH	 
(HH 
$strHH 
)HH  
]HH  !
publicII 
IActionResultII 
AddPhotoII %
(II% &
stringII& ,
idII- /
,II/ 0
[II1 2
FromBodyII2 :
]II: ;
stringII< B
photoUrlIIC K
)IIK L
{JJ 	
varKK 
userKK 
=KK 
_usersKK 
.KK 
FirstOrDefaultKK ,
(KK, -
uKK- .
=>KK/ 1
uKK2 3
.KK3 4
IdKK4 6
==KK7 9
idKK: <
)KK< =
;KK= >
ifLL 
(LL 
userLL 
==LL 
nullLL 
)LL 
returnMM 
NotFoundMM 
(MM  
)MM  !
;MM! "
userOO 
.OO 
PhotosOO 
.OO 
AddOO 
(OO 
photoUrlOO $
)OO$ %
;OO% &
returnPP 
OkPP 
(PP 
)PP 
;PP 
}QQ 	
}RR 
}SS ƒ.
Rc:\Users\HARRY\racetrac\live_project\dating-app\backend\UserService\Models\User.cs
	namespace 	
UserService
 
. 
Models 
{ 
public 

class 
User 
{ 
public 
string 
Id 
{ 
get 
; 
set  #
;# $
}% &
=' (
string) /
./ 0
Empty0 5
;5 6
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public		 
int		 
Age		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
public

 
string

 
Bio

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
=

( )
string

* 0
.

0 1
Empty

1 6
;

6 7
public 
string 
Location 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 
string 
Zipcode 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
string. 4
.4 5
Empty5 :
;: ;
public 
string 
Gender 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 
string 
InterestedIn "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
public 
List 
< 
string 
> 
Photos "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
new3 6
List7 ;
<; <
string< B
>B C
(C D
)D E
;E F
public 
DateTime 
	CreatedAt !
{" #
get$ '
;' (
set) ,
;, -
}. /
=0 1
DateTime2 :
.: ;
UtcNow; A
;A B
} 
public 

class 
CreateUserRequest "
{ 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
=* +
string, 2
.2 3
Empty3 8
;8 9
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
=) *
string+ 1
.1 2
Empty2 7
;7 8
public 
int 
Age 
{ 
get 
; 
set !
;! "
}# $
public 
string 
Bio 
{ 
get 
;  
set! $
;$ %
}& '
=( )
string* 0
.0 1
Empty1 6
;6 7
public 
string 
Location 
{  
get! $
;$ %
set& )
;) *
}+ ,
=- .
string/ 5
.5 6
Empty6 ;
;; <
public 
string 
Zipcode 
{ 
get  #
;# $
set% (
;( )
}* +
=, -
string. 4
.4 5
Empty5 :
;: ;
public 
string 
Gender 
{ 
get "
;" #
set$ '
;' (
}) *
=+ ,
string- 3
.3 4
Empty4 9
;9 :
public 
string 
InterestedIn "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
string3 9
.9 :
Empty: ?
;? @
} 
public   

class   
LoginRequest   
{!! 
public"" 
string"" 
Email"" 
{"" 
get"" !
;""! "
set""# &
;""& '
}""( )
=""* +
string"", 2
.""2 3
Empty""3 8
;""8 9
public## 
string## 
Password## 
{##  
get##! $
;##$ %
set##& )
;##) *
}##+ ,
=##- .
string##/ 5
.##5 6
Empty##6 ;
;##; <
}$$ 
}%% ®
Nc:\Users\HARRY\racetrac\live_project\dating-app\backend\UserService\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder 
. 
Services 
. 
AddSingleton 
< 
MongoDbService ,
>, -
(- .
). /
;/ 0
builder 
. 
Services 
. 
AddCors 
( 
options  
=>! #
{ 
options		 
.		 
	AddPolicy		 
(		 
$str		  
,		  !
policy		" (
=>		) +
{

 
policy 
. 
AllowAnyOrigin 
( 
) 
. 
AllowAnyMethod 
( 
) 
. 
AllowAnyHeader 
( 
) 
;  
} 
) 
; 
} 
) 
; 
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
app 
. 
UseCors 
( 
$str 
) 
; 
app 
. 

UseRouting 
( 
) 
; 
app 
. 
MapControllers 
( 
) 
; 
app 
. 
Run 
( 
$str 
)  
;  !